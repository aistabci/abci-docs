



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="ABCI User Guide, English version">
      
      
        <link rel="canonical" href="https://docs.abci.ai/en/abci-singularity-endpoint/">
      
      
        <meta name="author" content="AIST">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-4.6.3">
    
    
      
        <title>ABCI Singularity Endpoint - ABCI User Guide</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-118371652-2", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#abci-singularity-endpoint" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.abci.ai/en/" title="ABCI User Guide" aria-label="ABCI User Guide" class="md-header-nav__button md-logo">
          
            <img alt="logo" src="../img/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              ABCI User Guide
            </span>
            <span class="md-header-nav__topic">
              
                ABCI Singularity Endpoint
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/aistairc/abci-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.abci.ai/en/" title="ABCI User Guide" class="md-nav__button md-logo">
      
        <img alt="logo" src="../img/logo.png" width="48" height="48">
      
    </a>
    ABCI User Guide
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/aistairc/abci-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../01/" title="1. ABCI System Overview" class="md-nav__link">
      1. ABCI System Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../02/" title="2. ABCI System User Environment" class="md-nav__link">
      2. ABCI System User Environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../03/" title="3. Job Execution Environment" class="md-nav__link">
      3. Job Execution Environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../04/" title="4. Storage" class="md-nav__link">
      4. Storage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../05/" title="5. Environment Modules" class="md-nav__link">
      5. Environment Modules
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../06/" title="6. Python" class="md-nav__link">
      6. Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../07/" title="7. GPU" class="md-nav__link">
      7. GPU
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../08/" title="8. MPI" class="md-nav__link">
      8. MPI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../09/" title="9. Linux Containers" class="md-nav__link">
      9. Linux Containers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../10/" title="10. Software Development Environment" class="md-nav__link">
      10. Software Development Environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../appendix/installed-software/" title="Appendix. Configuration of Installed Software" class="md-nav__link">
      Appendix. Configuration of Installed Software
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../appendix/using-abci-with-hpci/" title="Appendix. Using ABCI with HPCI" class="md-nav__link">
      Appendix. Using ABCI with HPCI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../appendix/external-networks/" title="Appendix. Communications with External Networks" class="md-nav__link">
      Appendix. Communications with External Networks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../appendix/ssh-access/" title="Appendix. SSH Access to Compute Nodes" class="md-nav__link">
      Appendix. SSH Access to Compute Nodes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Applications
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Applications
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../apps/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../apps/tensorflow/" title="TensorFlow" class="md-nav__link">
      TensorFlow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../apps/tensorflow-keras/" title="TensorFlow Keras" class="md-nav__link">
      TensorFlow Keras
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../apps/pytorch/" title="PyTorch" class="md-nav__link">
      PyTorch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../apps/mxnet/" title="MXNet" class="md-nav__link">
      MXNet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../apps/chainer/" title="Chainer" class="md-nav__link">
      Chainer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../apps/others/" title="Others" class="md-nav__link">
      Others
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Tips
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tips
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/ngc/" title="NVIDIA NGC" class="md-nav__link">
      NVIDIA NGC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/remote-desktop/" title="Remote Desktop" class="md-nav__link">
      Remote Desktop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/awscli/" title="AWS CLI" class="md-nav__link">
      AWS CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/putty/" title="PuTTY" class="md-nav__link">
      PuTTY
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/jupyter-notebook/" title="Jupyter Notebook" class="md-nav__link">
      Jupyter Notebook
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/sregistry-cli/" title="Singularity Global Client" class="md-nav__link">
      Singularity Global Client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/spack/" title="Spack" class="md-nav__link">
      Spack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/datasets/" title="Datasets" class="md-nav__link">
      Datasets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/dl-amazon-ecr/" title="Amazon ECR" class="md-nav__link">
      Amazon ECR
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      ABCI Cloud Storage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        ABCI Cloud Storage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../abci-cloudstorage/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../abci-cloudstorage/cs-account/" title="Accounts and Access keys" class="md-nav__link">
      Accounts and Access keys
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../abci-cloudstorage/usage/" title="Usage" class="md-nav__link">
      Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../abci-cloudstorage/encryption/" title="Data encryption" class="md-nav__link">
      Data encryption
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../abci-cloudstorage/acl/" title="Access Control (1)" class="md-nav__link">
      Access Control (1) 
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../abci-cloudstorage/policy/" title="Access Control (2)" class="md-nav__link">
      Access Control (2) 
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../abci-cloudstorage/publishing-datasets/" title="Publishing Datasets" class="md-nav__link">
      Publishing Datasets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../abci-cloudstorage/caution/" title="Caution" class="md-nav__link">
      Caution
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../abci-datasets/" title="ABCI Datasets" class="md-nav__link">
      ABCI Datasets
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        ABCI Singularity Endpoint
      </label>
    
    <a href="./" title="ABCI Singularity Endpoint" class="md-nav__link md-nav__link--active">
      ABCI Singularity Endpoint
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    Preparation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#loading-environment-module" class="md-nav__link">
    Loading environment module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-access-token" class="md-nav__link">
    Creating Access Token
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-remote-endpoint" class="md-nav__link">
    Checking remote endpoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registering-access-token" class="md-nav__link">
    Registering Access Token
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remote-builder" class="md-nav__link">
    Remote Builder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#container-library-experimental" class="md-nav__link">
    Container Library (Experimental)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-and-registering-signing-keys-for-a-container-image" class="md-nav__link">
    Creating and Registering Signing Keys for a Container Image
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-key-pairs" class="md-nav__link">
    Creating Key Pairs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listing-keys" class="md-nav__link">
    Listing Keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registering-a-public-key-in-keystore" class="md-nav__link">
    Registering a Public Key in Keystore
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-public-keys-registered-in-keystore" class="md-nav__link">
    Getting Public Keys Registered in Keystore
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleting-keys" class="md-nav__link">
    Deleting Keys
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uploading-container-images" class="md-nav__link">
    Uploading Container Images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downloading-container-images" class="md-nav__link">
    Downloading Container Images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#searching-container-images" class="md-nav__link">
    Searching Container Images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleting-container-images" class="md-nav__link">
    Deleting Container Images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listing-container-images" class="md-nav__link">
    Listing Container Images
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../known-issues/" title="Known Issues" class="md-nav__link">
      Known Issues
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../system-updates/" title="System Updates" class="md-nav__link">
      System Updates
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://abci.ai/en/about_abci/info.html" title="Operation Status" class="md-nav__link">
      Operation Status
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contact/" title="Contact" class="md-nav__link">
      Contact
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      Links
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        Links
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="https://abci.ai/" title="ABCI Web page" class="md-nav__link">
      ABCI Web page
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://docs.abci.ai/portal/en/" title="ABCI User Portal Guide" class="md-nav__link">
      ABCI User Portal Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://portal.abci.ai/user/project_register_app.php?lang=en" title="ABCI User Portal (Registration)" class="md-nav__link">
      ABCI User Portal (Registration)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://portal.abci.ai/user/login.php?lang=en" title="ABCI User Portal (Login)" class="md-nav__link">
      ABCI User Portal (Login)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://docs.abci.ai/ja/" title="Japanese version" class="md-nav__link">
      Japanese version
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    Preparation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#loading-environment-module" class="md-nav__link">
    Loading environment module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-access-token" class="md-nav__link">
    Creating Access Token
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-remote-endpoint" class="md-nav__link">
    Checking remote endpoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registering-access-token" class="md-nav__link">
    Registering Access Token
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remote-builder" class="md-nav__link">
    Remote Builder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#container-library-experimental" class="md-nav__link">
    Container Library (Experimental)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-and-registering-signing-keys-for-a-container-image" class="md-nav__link">
    Creating and Registering Signing Keys for a Container Image
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-key-pairs" class="md-nav__link">
    Creating Key Pairs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listing-keys" class="md-nav__link">
    Listing Keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registering-a-public-key-in-keystore" class="md-nav__link">
    Registering a Public Key in Keystore
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-public-keys-registered-in-keystore" class="md-nav__link">
    Getting Public Keys Registered in Keystore
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleting-keys" class="md-nav__link">
    Deleting Keys
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uploading-container-images" class="md-nav__link">
    Uploading Container Images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downloading-container-images" class="md-nav__link">
    Downloading Container Images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#searching-container-images" class="md-nav__link">
    Searching Container Images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleting-container-images" class="md-nav__link">
    Deleting Container Images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listing-container-images" class="md-nav__link">
    Listing Container Images
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aistairc/abci-docs/edit/master/en/docs/abci-singularity-endpoint.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="abci-singularity-endpoint">ABCI Singularity Endpoint</h1>
<h2 id="overview">Overview</h2>
<p>ABCI Singularity Endpoint provides a singularity container service available within ABCI. This service consists of Remote Builder for remotely building container images using SingularityPRO and Container Library for storing and sharing the created container images. This service is available only within ABCI and cannot be accessed directly from outside of ABCI.</p>
<p>The following describes the basic operations for using this service in ABCI. See Sylabs <a href="https://sylabs.io/docs/">Document</a> for more information.</p>
<h2 id="preparation">Preparation</h2>
<h3 id="loading-environment-module">Loading environment module</h3>
<p>In order to use this service, load the module of SingularityPRO as follows.</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ module load singularitypro</span>
</code></pre></div>


<h3 id="creating-access-token">Creating Access Token</h3>
<p>You need to obtain an access token to authenticate your requests. The access token can be created by using the <code>get_singularity_token</code> command on the interactive node with your ABCI password, which is used to log in to ABCI User Portal.</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ get_singularity_token</span>
<span class="err">ABCI portal password :</span>
<span class="err">just a moment, please...</span>
<span class="err">  (The generated access token will be displayed.)</span>
</code></pre></div>


<p>Keep your access token in a safe place for a later registration step.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The access token is a very long single line of text, so be careful not to include unnecessary characters such as newlines.</p>
</div>
<h3 id="checking-remote-endpoint">Checking remote endpoint</h3>
<p>To check that ABCI Singularity Endpoint (cloud.se.abci.local) is correctly configured as a remote endpoint, use <code>singularity remote list</code> command.</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">username@es1 ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">singularity</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">list</span><span class="w"></span>
<span class="n">Cloud</span><span class="w"> </span><span class="n">Services</span><span class="w"> </span><span class="n">Endpoints</span><span class="w"></span>
<span class="o">========================</span><span class="w"></span>

<span class="n">NAME</span><span class="w">         </span><span class="n">URI</span><span class="w">                  </span><span class="n">ACTIVE</span><span class="w">  </span><span class="k">GLOBAL</span><span class="w">  </span><span class="n">EXCLUSIVE</span><span class="w"></span>
<span class="n">ABCI</span><span class="w">         </span><span class="n">cloud</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="n">abci</span><span class="p">.</span><span class="k">local</span><span class="w">  </span><span class="n">YES</span><span class="w">     </span><span class="n">YES</span><span class="w">     </span><span class="k">NO</span><span class="w"></span>
<span class="n">SylabsCloud</span><span class="w">  </span><span class="n">cloud</span><span class="p">.</span><span class="n">sylabs</span><span class="p">.</span><span class="n">io</span><span class="w">      </span><span class="k">NO</span><span class="w">      </span><span class="n">YES</span><span class="w">     </span><span class="k">NO</span><span class="w"></span>

<span class="n">Keyservers</span><span class="w"></span>
<span class="o">==========</span><span class="w"></span>

<span class="n">URI</span><span class="w">                         </span><span class="k">GLOBAL</span><span class="w">  </span><span class="n">INSECURE</span><span class="w">  </span><span class="k">ORDER</span><span class="w"></span>
<span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">keys</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="n">abci</span><span class="p">.</span><span class="k">local</span><span class="w">  </span><span class="n">YES</span><span class="w">     </span><span class="k">NO</span><span class="w">        </span><span class="mi">1</span><span class="o">*</span><span class="w"></span>

<span class="o">*</span><span class="w"> </span><span class="n">Active</span><span class="w"> </span><span class="n">cloud</span><span class="w"> </span><span class="n">services</span><span class="w"> </span><span class="n">keyserver</span><span class="w"></span>
<span class="o">[</span><span class="n">username@es1 ~</span><span class="o">]</span><span class="err">$</span><span class="w"></span>
</code></pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SylabsCloud is a public service endpoint operated by <a href="https://sylabs.io/">Sylabs</a>. It is available by signing in to <a href="https://cloud.sylabs.io/">https://cloud.sylabs.io/</a> and obtaining an access token.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Singularity container images can also be retrieved using the Singularity Global Client. For details, refer to <a href="../tips/sregistry-cli/">Singularity Global Client</a>.</p>
</div>
<h3 id="registering-access-token">Registering Access Token</h3>
<p>To register the access token obtained above with your configuration, use <code>singularity remote login</code>command for ABCI Singularity Endpoint.</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ singularity remote login ABCI</span>
<span class="c">INFO:    Authenticating with remote: ABCI</span>
<span class="err">Generate an API Key at https://cloud.se.abci.local/auth/tokens, and paste here:</span>
<span class="err">API Key:</span>
<span class="c">INFO:    API Key Verified!</span>
<span class="err">[username@es1 ~]$</span>
</code></pre></div>


<p>When you have created an access token again, use the above command to register it. The old access token is overwritten by the new one.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The validity period of access tokens is one year.</p>
</div>
<h2 id="remote-builder">Remote Builder</h2>
<p>First, create a definition file to build a container image. The following example defines installation of additional packages to the container image and commands to be executed when the container image is run, based on Ubuntu container image from Docker Hub. For more information about definition files, see <a href="https://repo.sylabs.io/c/0f6898986ad0b646b5ce6deba21781ac62cb7e0a86a5153bbb31732ee6593f43/guides/singularitypro37-user-guide/definition_files.html">Definition Files</a>.</p>
<div class="codehilite"><pre><span></span><code><span class="p">[</span><span class="n">username</span><span class="err">@</span><span class="n">es1</span> <span class="o">~</span><span class="p">]</span><span class="err">$</span> <span class="n">vi</span> <span class="n">ubuntu</span><span class="p">.</span><span class="n">def</span>
<span class="p">[</span><span class="n">username</span><span class="err">@</span><span class="n">es1</span> <span class="o">~</span><span class="p">]</span><span class="err">$</span> <span class="n">cat</span> <span class="n">ubuntu</span><span class="p">.</span><span class="n">def</span>
<span class="nl">Bootstrap</span><span class="p">:</span> <span class="n">docker</span>
<span class="nl">From</span><span class="p">:</span> <span class="nl">ubuntu</span><span class="p">:</span><span class="mf">18.04</span>

<span class="nf">%post</span>
    <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
    <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">lsb</span><span class="o">-</span><span class="n">release</span>

<span class="nf">%runscript</span>
    <span class="n">lsb_release</span> <span class="o">-</span><span class="n">d</span>

<span class="p">[</span><span class="n">username</span><span class="err">@</span><span class="n">es1</span> <span class="o">~</span><span class="p">]</span><span class="err">$</span> 
</code></pre></div>


<p>Next, to create the container image "ubuntu.sif" by Remote Build with "ubuntu.def", specify <code>--remote</code> to the command <code>singularity build</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ singularity build --remote ubuntu.sif ubuntu.def</span>
<span class="c">INFO:    Remote &quot;default&quot; added.</span>
<span class="c">INFO:    Authenticating with remote: default</span>
<span class="c">INFO:    API Key Verified!</span>
<span class="c">INFO:    Remote &quot;default&quot; now in use.</span>
<span class="c">INFO:    Starting build...</span>
<span class="err">:</span>
<span class="err">:</span>
<span class="c">INFO:    Build complete: ubuntu.sif</span>
<span class="err">[username@es1 ~]$ </span>
</code></pre></div>


<p>You can run the container image with <code>singularity run</code> command as follows:</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ qrsh -g grpname -l rt_C.small=1 -l h_rt=1:00:00</span>
<span class="err">[username@g0001 ~]$ module load singularitypro</span>
<span class="err">[username@g0001 ~]$ singularity run ubuntu.sif</span>
<span class="c">Description:    Ubuntu 18.04.5 LTS</span>
<span class="err">[username@g0001 ~]$ </span>
</code></pre></div>


<p>The <code>lsb_release -d</code> command specified in the definition file is executed and the result is printed.</p>
<h2 id="container-library-experimental">Container Library (Experimental)</h2>
<p>You can push your container images to Container Library and make those available to other ABCI users. Each user can store up to a total of 100 GiB.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is no access control function for the container images pushed to Container Library. This means that anyone who uses ABCI will be able to access them, so make sure the container images are appropriate.</p>
</div>
<h3 id="creating-and-registering-signing-keys-for-a-container-image">Creating and Registering Signing Keys for a Container Image</h3>
<p>To push a container image to Container Library and publish it in ABCI, create a key pair and register the public key in Keystore.The author of the container image can sign the container image using the private key, and the user of the container image can verify the signature using the public key registered in Keystore.</p>
<h4 id="creating-key-pairs">Creating Key Pairs</h4>
<p>To create key pairs, use <code>singularity key newpair</code> command.</p>
<div class="codehilite"><pre><span></span><code>[<span class="n">username</span><span class="nv">@es1</span> ~]$ <span class="n">singularity</span> <span class="nb">key</span> <span class="n">newpair</span>
<span class="n">Enter</span> <span class="n">your</span> <span class="nb">name</span> (<span class="nb">e</span>.<span class="n">g</span>., <span class="n">John</span> <span class="n">Doe</span>) : 
<span class="n">Enter</span> <span class="n">your</span> <span class="n">email</span> <span class="n">address</span> (<span class="nb">e</span>.<span class="n">g</span>., <span class="n">john</span>.<span class="n">doe</span><span class="nv">@example</span>.<span class="n">com</span>) : 
<span class="n">Enter</span> <span class="nb">optional</span> <span class="nb">comment</span> (<span class="nb">e</span>.<span class="n">g</span>., <span class="n">development</span> <span class="nb">keys</span>) : 
<span class="n">Enter</span> <span class="n">a</span> <span class="n">passphrase</span> : 
<span class="n">Retype</span> <span class="n">your</span> <span class="n">passphrase</span> :
<span class="n">Would</span> <span class="n">you</span> <span class="nb">like</span> <span class="nb">to</span> <span class="nb">push</span> <span class="n">it</span> <span class="nb">to</span> <span class="n">the</span> <span class="n">keystore</span>? [<span class="n">Y</span>,<span class="n">n</span>] 
<span class="n">Generating</span> <span class="n">Entity</span> <span class="o">and</span> <span class="n">OpenPGP</span> <span class="n">Key</span> <span class="nb">Pair</span>... <span class="nb">done</span>
</code></pre></div>


<p>Each input value is described as follows:</p>
<table>
<thead>
<tr>
<th align="left">item</th>
<th align="left">value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Enter your name</td>
<td align="left">Enter the ABCI account name.</td>
</tr>
<tr>
<td align="left">Enter your email address</td>
<td align="left">Although it says email address, enter the ABCI account name.</td>
</tr>
<tr>
<td align="left">Enter optional comment</td>
<td align="left">Enter comments you want to attach to this key pair.</td>
</tr>
<tr>
<td align="left">Enter a passphrase</td>
<td align="left">Determine your passphrase and enter it. It is going to be necessary when signing a container image.</td>
</tr>
<tr>
<td align="left">Would you like to push it to the keystore?</td>
<td align="left">Enter <code>Y</code> to upload the public key to Keystore.</td>
</tr>
</tbody>
</table>
<h4 id="listing-keys">Listing Keys</h4>
<p>To retrieve information about the public keys in your local keyring, including ones you created, use <code>singularity key list</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ singularity key list</span>
<span class="err">Public key listing (/home/username/.singularity/sypgp/pgp-public):</span>
<span class="err">:</span>
<span class="err">:</span>
<span class="err">   --------</span>
<span class="err">7) U: username (comment) &lt;username&gt;</span>
<span class="err">   C: 2020-06-15 03:40:05 +0900 JST</span>
<span class="err">   F: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span>
<span class="err">   L: 4096</span>
<span class="err">   --------</span>
<span class="err">[username@es1 ~]$</span>
</code></pre></div>


<p>To retrieve key information registered in Keystore, specify the ABCI account in <code>singularity key search -l</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">username@es1 ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">singularity</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="k">search</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">username</span><span class="w"></span>
<span class="n">Showing</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">results</span><span class="w"></span>

<span class="n">FINGERPRINT</span><span class="w">                               </span><span class="n">ALGORITHM</span><span class="w">  </span><span class="n">BITS</span><span class="w">  </span><span class="n">CREATION</span><span class="w"> </span><span class="nc">DATE</span><span class="w">                  </span><span class="n">EXPIRATION</span><span class="w"> </span><span class="nc">DATE</span><span class="w">  </span><span class="n">STATUS</span><span class="w">     </span><span class="n">NAME</span><span class="o">/</span><span class="n">EMAIL</span><span class="w"></span>
<span class="n">YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY</span><span class="w">  </span><span class="n">RSA</span><span class="w">        </span><span class="mi">4096</span><span class="w">  </span><span class="mi">2020</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="w"> </span><span class="mi">03</span><span class="err">:</span><span class="mi">40</span><span class="err">:</span><span class="mi">05</span><span class="w"> </span><span class="o">+</span><span class="mi">0900</span><span class="w"> </span><span class="n">JST</span><span class="w">  </span><span class="o">[</span><span class="n">ultimate</span><span class="o">]</span><span class="w">       </span><span class="o">[</span><span class="n">enabled</span><span class="o">]</span><span class="w">  </span><span class="n">username</span><span class="w"> </span><span class="p">(</span><span class="n">comment</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="n">username</span><span class="o">&gt;</span><span class="w"></span>

<span class="o">[</span><span class="n">username@es1 ~</span><span class="o">]</span><span class="err">$</span><span class="w"></span>
</code></pre></div>


<h4 id="registering-a-public-key-in-keystore">Registering a Public Key in Keystore</h4>
<p>If you did not specify the option to upload a public key to Keystore, you can upload it later.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Public keys registered in Keystore cannot be deleted.</p>
</div>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ singularity key list</span>
<span class="err">0) U: username (comment) username</span>
<span class="err">   C: 2020-08-08 04:28:35 +0900 JST</span>
<span class="err">   F: ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ</span>
<span class="err">   L: 4096</span>
<span class="err">   --------</span>
</code></pre></div>


<p>To upload this public key number 0, specify the fingerprint shown in <code>F</code> as the <code>singularity key push</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">username@es1 ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">singularity</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="n">ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ</span><span class="w"></span>
<span class="k">public</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="err">`</span><span class="n">ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ</span><span class="err">&#39;</span><span class="w"> </span><span class="n">pushed</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">successfully</span><span class="w"></span>

<span class="o">[</span><span class="n">username@es1 ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">singularity</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="k">search</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">username</span><span class="w"></span>
<span class="n">Showing</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">results</span><span class="w"></span>

<span class="n">FINGERPRINT</span><span class="w">                               </span><span class="n">ALGORITHM</span><span class="w">  </span><span class="n">BITS</span><span class="w">  </span><span class="n">CREATION</span><span class="w"> </span><span class="nc">DATE</span><span class="w">                  </span><span class="n">EXPIRATION</span><span class="w"> </span><span class="nc">DATE</span><span class="w">  </span><span class="n">STATUS</span><span class="w">     </span><span class="n">NAME</span><span class="o">/</span><span class="n">EMAIL</span><span class="w"></span>
<span class="n">ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ</span><span class="w">  </span><span class="n">RSA</span><span class="w">        </span><span class="mi">4096</span><span class="w">  </span><span class="mi">2020</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="w"> </span><span class="mi">03</span><span class="err">:</span><span class="mi">40</span><span class="err">:</span><span class="mi">05</span><span class="w"> </span><span class="o">+</span><span class="mi">0900</span><span class="w"> </span><span class="n">JST</span><span class="w">  </span><span class="o">[</span><span class="n">ultimate</span><span class="o">]</span><span class="w">       </span><span class="o">[</span><span class="n">enabled</span><span class="o">]</span><span class="w">  </span><span class="n">username</span><span class="w"> </span><span class="p">(</span><span class="n">comment</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="n">username</span><span class="o">&gt;</span><span class="w"></span>
</code></pre></div>


<h4 id="getting-public-keys-registered-in-keystore">Getting Public Keys Registered in Keystore</h4>
<p>Public keys registered in Keystore can be downloaded and stored in your keyring. The following example downloads and saves the public key found by searching for username2. You can also search for a string that matches the comment attached to the key. The last parameter of <code>singularity key pull AAAA....</code> is a fingerprint to specify which public key to download.</p>
<div class="codehilite"><pre><span></span><code><span class="hll"><span class="o">[</span>username@es1 ~<span class="o">]</span>$ singularity key search -l username2
</span>Showing <span class="m">2</span> results

FINGERPRINT                               ALGORITHM  BITS  CREATION DATE                  EXPIRATION DATE  STATUS     NAME/EMAIL
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA  RSA        <span class="m">4096</span>  <span class="m">2020</span>-06-22 <span class="m">11</span>:51:45 +0900 JST  <span class="o">[</span>ultimate<span class="o">]</span>       <span class="o">[</span>enabled<span class="o">]</span>  username2 <span class="o">(</span>comment<span class="o">)</span> &lt;username2&gt;

<span class="hll"><span class="o">[</span>username@es1 ~<span class="o">]</span>$ singularity key pull AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span><span class="m">1</span> key<span class="o">(</span>s<span class="o">)</span> added to keyring of trust /home/username/.singularity/sypgp/pgp-public
<span class="hll"><span class="o">[</span>username@es1 ~<span class="o">]</span>$ singularity key list
</span>:
:
<span class="m">1</span><span class="o">)</span> U: username2 <span class="o">(</span>comment<span class="o">)</span> &lt;username2&gt;
   C: <span class="m">2020</span>-08-10 <span class="m">11</span>:51:45 +0900 JST
   F: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
   L: <span class="m">4096</span>
   --------
<span class="o">[</span>username@es1 ~<span class="o">]</span>$
</code></pre></div>


<h4 id="deleting-keys">Deleting Keys</h4>
<p>You can remove a public key from your keyring by specifying a key fingerprint using <code>singularity key remove</code> command. Public keys registered in Keystore cannot be deleted.</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ singularity key remove AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
</code></pre></div>


<h3 id="uploading-container-images">Uploading Container Images</h3>
<p>Before uploading a container image to Container Library, sign the container image.
Check the key number by using the <code>singularity key list -s</code> command, and sign the container by using the <code>singularity sign</code> command with the <code>-k</code> option to specify the key number.
The following example uses the second key to sign <code>ubuntu.sif</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="hll"><span class="o">[</span>username@es1 ~<span class="o">]</span>$ singularity key list -s
</span>Public key listing <span class="o">(</span>/home/username/.singularity/sypgp/pgp-secret<span class="o">)</span>:
:
:
   --------
<span class="m">2</span><span class="o">)</span> U: username <span class="o">(</span>comment<span class="o">)</span> &lt;username&gt;
   C: <span class="m">2020</span>-06-15 <span class="m">03</span>:40:05 +0900 JST
   F: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
   L: <span class="m">4096</span>
   --------
<span class="hll"><span class="o">[</span>username@es1 ~<span class="o">]</span>$ singularity sign -k <span class="m">2</span> ./ubuntu.sif
</span>Signing image: ./ubuntu.sif
Enter key passphrase : 
Signature created and applied to ./ubuntu.sif
</code></pre></div>


<p>The location of container images in Container Library is represented by a URI <code>library://username/collection/container:tag</code>. Refer to the description of each component below to determine the URI.</p>
<table>
<thead>
<tr>
<th align="left">item</th>
<th align="left">value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">username</td>
<td align="left">Specifies your ABCI account</td>
</tr>
<tr>
<td align="left">collection</td>
<td align="left">Specify collection name as any string</td>
</tr>
<tr>
<td align="left">container</td>
<td align="left">Specify the container image name as any string.</td>
</tr>
<tr>
<td align="left">tag</td>
<td align="left">A string identifying the same container image. A string such as version, release date, revision number or <code>latest</code>.</td>
</tr>
</tbody>
</table>
<p>Here is an example of uploading the container image <code>ubuntu</code>, specifying the collection name <code>abci-lib</code> and the tag name <code>latest</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ singularity push ubuntu.sif library://username/abci-lib/ubuntu:latest</span>
<span class="c">INFO:    Container is trusted - run &#39;singularity key list&#39; to list your trusted keys</span>
<span class="c"> 35.36 MiB / 35.36 MiB [===========================================================================================================================================================================================================] 100.00% 182.68 MiB/s 0s</span>
<span class="err">[username@es1 ~]$</span>
</code></pre></div>


<h3 id="downloading-container-images">Downloading Container Images</h3>
<p>The container image uploaded to Container Library can be downloaded as follows:</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ singularity pull library://username/abci-lib/ubuntu:latest</span>
<span class="c">INFO:    Downloading library image</span>
<span class="c"> 35.37 MiB / 35.37 MiB [=============================================================================================================================================================================================================] 100.00% 353.47 MiB/s 0s</span>
<span class="c">INFO:    Download complete: ubuntu_latest.sif</span>
<span class="err">[username@es1 ~]$</span>
</code></pre></div>


<p>If the signature cannot be verified, you will see a warning message similar to the following, but the download will continue.</p>
<div class="codehilite"><pre><span></span><code><span class="n">WARNING</span><span class="o">:</span> <span class="n">Skipping</span> <span class="n">container</span> <span class="n">verification</span>
</code></pre></div>


<p>You can also use <code>singularity verify</code> to verify the signature after downloading it. 
The following example validates the signature with the public key that is registered in Keystore. The output is <code>LOCAL</code> rather than <code>REMOTE</code> if it is verified with the public key registered in your keyring. If it cannot be verified, a WARNING message is printed.</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">username@es1 ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">singularity</span><span class="w"> </span><span class="n">verify</span><span class="w"> </span><span class="n">ubuntu_latest</span><span class="p">.</span><span class="n">sif</span><span class="w"></span>
<span class="n">Verifying</span><span class="w"> </span><span class="nc">image</span><span class="err">:</span><span class="w"> </span><span class="n">ubuntu_latest</span><span class="p">.</span><span class="n">sif</span><span class="w"></span>
<span class="o">[</span><span class="n">REMOTE</span><span class="o">]</span><span class="w">  </span><span class="n">Signing</span><span class="w"> </span><span class="nl">entity</span><span class="p">:</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="p">(</span><span class="n">comment</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="n">username</span><span class="o">&gt;</span><span class="w"></span>
<span class="o">[</span><span class="n">REMOTE</span><span class="o">]</span><span class="w">  </span><span class="nl">Fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB</span><span class="w"></span>
<span class="n">Objects</span><span class="w"> </span><span class="nl">verified</span><span class="p">:</span><span class="w"></span>
<span class="n">ID</span><span class="w">  </span><span class="o">|</span><span class="k">GROUP</span><span class="w">   </span><span class="o">|</span><span class="n">LINK</span><span class="w">    </span><span class="o">|</span><span class="n">TYPE</span><span class="w"></span>
<span class="c1">------------------------------------------------</span>
<span class="mi">1</span><span class="w">   </span><span class="o">|</span><span class="mi">1</span><span class="w">       </span><span class="o">|</span><span class="k">NONE</span><span class="w">    </span><span class="o">|</span><span class="n">Def</span><span class="p">.</span><span class="k">FILE</span><span class="w"></span>
<span class="mi">2</span><span class="w">   </span><span class="o">|</span><span class="mi">1</span><span class="w">       </span><span class="o">|</span><span class="k">NONE</span><span class="w">    </span><span class="o">|</span><span class="n">JSON</span><span class="p">.</span><span class="n">Generic</span><span class="w"></span>
<span class="mi">3</span><span class="w">   </span><span class="o">|</span><span class="mi">1</span><span class="w">       </span><span class="o">|</span><span class="k">NONE</span><span class="w">    </span><span class="o">|</span><span class="n">FS</span><span class="w"></span>
<span class="n">Container</span><span class="w"> </span><span class="nl">verified</span><span class="p">:</span><span class="w"> </span><span class="n">ubuntu_latest</span><span class="p">.</span><span class="n">sif</span><span class="w"></span>
</code></pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can still run the container image if validation fails, but it is recommended that you use a verifiable container image.</p>
</div>
<h3 id="searching-container-images">Searching Container Images</h3>
<p>To search for container images uploaded to Container Library by keyword, use <code>singularity search</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">username@es1 ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">singularity</span><span class="w"> </span><span class="k">search</span><span class="w"> </span><span class="n">hello</span><span class="w"></span>
<span class="k">No</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">found</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s1">&#39;hello&#39;</span><span class="w"></span>

<span class="k">No</span><span class="w"> </span><span class="n">collections</span><span class="w"> </span><span class="k">found</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s1">&#39;hello&#39;</span><span class="w"></span>

<span class="k">Found</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">containers</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s1">&#39;hello&#39;</span><span class="w"></span>
<span class="w">    </span><span class="nl">library</span><span class="p">:</span><span class="o">//</span><span class="n">username</span><span class="o">/</span><span class="n">abci</span><span class="o">-</span><span class="n">lib</span><span class="o">/</span><span class="n">helloworld</span><span class="w"></span>
<span class="w">        </span><span class="nl">Tags</span><span class="p">:</span><span class="w"> </span><span class="n">latest</span><span class="w"></span>
</code></pre></div>


<h3 id="deleting-container-images">Deleting Container Images</h3>
<p>To delete a container image from Container Library, use <code>singularity delete</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ singularity delete library://username/abci-lib/helloworld:latest</span>
</code></pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can delete container images such as <code>library://username/abci-lib/helloworld:latest</code>, which are associated with at least one tag or ID, but you can not delete container names such as <code>library://username/abci-lib/helloworld</code>.</p>
</div>
<h3 id="listing-container-images">Listing Container Images</h3>
<p>To list the container images uploaded to Container Library, use <code>list_singularity_images</code>.
The container images are displayed in the URI format <code>library://username/collection/container</code>.
If the container image has been tagged, <code>Tag</code> appears on the next line of the container image URI. If no tag is given, <code>Unique ID</code> is displayed instead.</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">username@es1 ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">list_singularity_images</span><span class="w"></span>
<span class="nl">library</span><span class="p">:</span><span class="o">//</span><span class="n">username</span><span class="o">/</span><span class="n">collection1</span><span class="o">/</span><span class="n">container1</span><span class="w"></span>
<span class="w">    </span><span class="nl">Tag</span><span class="p">:</span><span class="w"> </span><span class="n">latest</span><span class="w"></span>

<span class="nl">library</span><span class="p">:</span><span class="o">//</span><span class="n">username</span><span class="o">/</span><span class="n">collection2</span><span class="o">/</span><span class="n">container2</span><span class="w"></span>
<span class="w">    </span><span class="k">Unique</span><span class="w"> </span><span class="nl">ID</span><span class="p">:</span><span class="w"> </span><span class="n">sha256</span><span class="p">.</span><span class="n">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><span class="w"></span>

<span class="nl">library</span><span class="p">:</span><span class="o">//</span><span class="n">username</span><span class="o">/</span><span class="n">collection3</span><span class="o">/</span><span class="n">container3</span><span class="w"></span>
</code></pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If neither <code>Tag</code> nor <code>Unique ID</code> is displayed, it means that there is no container image in the container.</p>
</div>
<p>You can also add option <code>-v</code> to <code>list_singularity_images</code> to display the fingerprint (if present) and image size.</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">username@es1 ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">list_singularity_images</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"></span>
<span class="nl">library</span><span class="p">:</span><span class="o">//</span><span class="n">username</span><span class="o">/</span><span class="n">collection1</span><span class="o">/</span><span class="n">container1</span><span class="w"></span>
<span class="w">    </span><span class="nl">Tag</span><span class="p">:</span><span class="w"> </span><span class="n">latest</span><span class="w"></span>
<span class="w">    </span><span class="nc">Image</span><span class="w"> </span><span class="k">Size</span><span class="err">:</span><span class="w"> </span><span class="mf">10.00</span><span class="w"> </span><span class="n">MB</span><span class="w"></span>
<span class="w">    </span><span class="n">Finger</span><span class="w"> </span><span class="nl">Prints</span><span class="p">:</span><span class="w"> </span><span class="n">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span class="w"></span>

<span class="nl">library</span><span class="p">:</span><span class="o">//</span><span class="n">username</span><span class="o">/</span><span class="n">collection2</span><span class="o">/</span><span class="n">container2</span><span class="w"></span>
<span class="w">    </span><span class="k">Unique</span><span class="w"> </span><span class="nl">ID</span><span class="p">:</span><span class="w"> </span><span class="n">sha256</span><span class="p">.</span><span class="n">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><span class="w"></span>
<span class="w">    </span><span class="nc">Image</span><span class="w"> </span><span class="k">Size</span><span class="err">:</span><span class="w"> </span><span class="mf">20.00</span><span class="w"> </span><span class="n">MB</span><span class="w"></span>

<span class="nl">library</span><span class="p">:</span><span class="o">//</span><span class="n">username</span><span class="o">/</span><span class="n">collection3</span><span class="o">/</span><span class="n">container3</span><span class="w"></span>
</code></pre></div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../abci-datasets/" title="ABCI Datasets" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                ABCI Datasets
              </span>
            </div>
          </a>
        
        
          <a href="../faq/" title="FAQ" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                FAQ
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 National Institute of Advanced Industrial Science and Technology (AIST)
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1.2",url:{base:".."}})</script>
      
    
  </body>
</html>