<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="ABCI User Guide, English version"><link rel="canonical" href="https://docs.abci.ai/en/abci-cloudstorage/policy/"><meta name="author" content="AIST"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.1, mkdocs-material-4.3.1"><title>Access Control (2)  - ABCI User Guide</title><link rel="stylesheet" href="../../assets/stylesheets/application.4031d38b.css"><link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css"><meta name="theme-color" content="#ef5350"><script src="../../assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=swap"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../../assets/fonts/material-icons.css"><script>window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-118371652-2", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })</script><script async src="https://www.google-analytics.com/analytics.js"></script></head><body dir="ltr" data-md-color-primary="red" data-md-color-accent="red"><svg class="md-svg"><defs><svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#access-control-2-policy-" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="https://docs.abci.ai/en/" title="ABCI User Guide" class="md-header-nav__button md-logo"><i class="md-icon">cloud</i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">ABCI User Guide</span><span class="md-header-nav__topic">Access Control (2) </span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">Type to start searching</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a href="https://github.com/aistairc/abci-docs/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">GitHub</div></a></div></div></div></nav></header><div class="md-container"><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="https://docs.abci.ai/en/" title="ABCI User Guide" class="md-nav__button md-logo"><i class="md-icon">cloud</i></a>ABCI User Guide</label><div class="md-nav__source"><a href="https://github.com/aistairc/abci-docs/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">GitHub</div></a></div><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../.." title="Introduction" class="md-nav__link">Introduction</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2"><label class="md-nav__link" for="nav-2">User Guide</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-2">User Guide</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../01/" title="1. ABCI System Overview" class="md-nav__link">1. ABCI System Overview</a></li><li class="md-nav__item"><a href="../../02/" title="2. ABCI System User Environment" class="md-nav__link">2. ABCI System User Environment</a></li><li class="md-nav__item"><a href="../../03/" title="3. Job Execution Environment" class="md-nav__link">3. Job Execution Environment</a></li><li class="md-nav__item"><a href="../../04/" title="4. Storage" class="md-nav__link">4. Storage</a></li><li class="md-nav__item"><a href="../../05/" title="5. Environment Modules" class="md-nav__link">5. Environment Modules</a></li><li class="md-nav__item"><a href="../../06/" title="6. Python" class="md-nav__link">6. Python</a></li><li class="md-nav__item"><a href="../../07/" title="7. GPU" class="md-nav__link">7. GPU</a></li><li class="md-nav__item"><a href="../../08/" title="8. MPI" class="md-nav__link">8. MPI</a></li><li class="md-nav__item"><a href="../../09/" title="9. Linux Containers" class="md-nav__link">9. Linux Containers</a></li><li class="md-nav__item"><a href="../../10/" title="10. Software Development Environment" class="md-nav__link">10. Software Development Environment</a></li><li class="md-nav__item"><a href="../../appendix/installed-software/" title="Appendix. Configuration of Installed Software" class="md-nav__link">Appendix. Configuration of Installed Software</a></li><li class="md-nav__item"><a href="../../appendix/using-abci-with-hpci/" title="Appendix. Using ABCI with HPCI" class="md-nav__link">Appendix. Using ABCI with HPCI</a></li><li class="md-nav__item"><a href="../../appendix/external-networks/" title="Appendix. Communications with External Networks" class="md-nav__link">Appendix. Communications with External Networks</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3"><label class="md-nav__link" for="nav-3">Applications</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-3">Applications</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../apps/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../../apps/tensorflow/" title="TensorFlow" class="md-nav__link">TensorFlow</a></li><li class="md-nav__item"><a href="../../apps/tensorflow-keras/" title="TensorFlow Keras" class="md-nav__link">TensorFlow Keras</a></li><li class="md-nav__item"><a href="../../apps/pytorch/" title="PyTorch" class="md-nav__link">PyTorch</a></li><li class="md-nav__item"><a href="../../apps/mxnet/" title="MXNet" class="md-nav__link">MXNet</a></li><li class="md-nav__item"><a href="../../apps/chainer/" title="Chainer" class="md-nav__link">Chainer</a></li><li class="md-nav__item"><a href="../../apps/others/" title="Others" class="md-nav__link">Others</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4"><label class="md-nav__link" for="nav-4">Tips</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-4">Tips</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../tips/remote-desktop/" title="Remote Desktop" class="md-nav__link">Remote Desktop</a></li><li class="md-nav__item"><a href="../../tips/awscli/" title="AWS CLI" class="md-nav__link">AWS CLI</a></li><li class="md-nav__item"><a href="../../tips/putty/" title="PuTTY" class="md-nav__link">PuTTY</a></li><li class="md-nav__item"><a href="../../tips/jupyter-notebook/" title="Jupyter Notebook" class="md-nav__link">Jupyter Notebook</a></li><li class="md-nav__item"><a href="../../tips/sregistry-cli/" title="Singularity Global Client" class="md-nav__link">Singularity Global Client</a></li><li class="md-nav__item"><a href="../../tips/spack/" title="Spack" class="md-nav__link">Spack</a></li><li class="md-nav__item"><a href="../../tips/datasets/" title="Datasets" class="md-nav__link">Datasets</a></li><li class="md-nav__item"><a href="../../tips/dl-amazon-ecr/" title="Amazon ECR" class="md-nav__link">Amazon ECR</a></li></ul></nav></li><li class="md-nav__item"><a href="../../ngc/" title="NVIDIA NGC" class="md-nav__link">NVIDIA NGC</a></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked><label class="md-nav__link" for="nav-6">ABCI Cloud Storage</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-6">ABCI Cloud Storage</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../cs-account/" title="Accounts and Access keys" class="md-nav__link">Accounts and Access keys</a></li><li class="md-nav__item"><a href="../usage/" title="Usage" class="md-nav__link">Usage</a></li><li class="md-nav__item"><a href="../encryption/" title="Data encryption" class="md-nav__link">Data encryption</a></li><li class="md-nav__item"><a href="../acl/" title="Access Control (1)" class="md-nav__link">Access Control (1) </a></li><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">Access Control (2) </label><a href="./" title="Access Control (2)" class="md-nav__link md-nav__link--active">Access Control (2) </a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#default-permission" title="Default Permission" class="md-nav__link">Default Permission</a></li><li class="md-nav__item"><a href="#setting-policy" title="Setting Policy" class="md-nav__link">Setting Policy</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#example-1-limiting-bucket-access-by-accounts" title="Example 1:  Limiting Bucket Access By Accounts" class="md-nav__link">Example 1:  Limiting Bucket Access By Accounts</a></li><li class="md-nav__item"><a href="#example-2-limiting-bucket-access-by-hosts" title="Example 2:  Limiting Bucket Access By Hosts" class="md-nav__link">Example 2:  Limiting Bucket Access By Hosts</a></li></ul></nav></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="../../faq/" title="FAQ" class="md-nav__link">FAQ</a></li><li class="md-nav__item"><a href="../../known-issues/" title="Known Issues" class="md-nav__link">Known Issues</a></li><li class="md-nav__item"><a href="../../system-updates/" title="System Updates" class="md-nav__link">System Updates</a></li><li class="md-nav__item"><a href="https://abci.ai/en/about_abci/info.html" title="Operation Status" class="md-nav__link">Operation Status</a></li><li class="md-nav__item"><a href="../../contact/" title="Contact" class="md-nav__link">Contact</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12"><label class="md-nav__link" for="nav-12">Links</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-12">Links</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="https://abci.ai/" title="ABCI Web page" class="md-nav__link">ABCI Web page</a></li><li class="md-nav__item"><a href="https://docs.abci.ai/portal/en/" title="ABCI User Portal Guide" class="md-nav__link">ABCI User Portal Guide</a></li><li class="md-nav__item"><a href="https://portal.abci.ai/user/project_register_app.php?lang=en" title="ABCI User Portal (Registration)" class="md-nav__link">ABCI User Portal (Registration)</a></li><li class="md-nav__item"><a href="https://portal.abci.ai/user/login.php?lang=en" title="ABCI User Portal (Login)" class="md-nav__link">ABCI User Portal (Login)</a></li></ul></nav></li><li class="md-nav__item"><a href="https://docs.abci.ai/ja/" title="Japanese version" class="md-nav__link">Japanese version</a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#default-permission" title="Default Permission" class="md-nav__link">Default Permission</a></li><li class="md-nav__item"><a href="#setting-policy" title="Setting Policy" class="md-nav__link">Setting Policy</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#example-1-limiting-bucket-access-by-accounts" title="Example 1:  Limiting Bucket Access By Accounts" class="md-nav__link">Example 1:  Limiting Bucket Access By Accounts</a></li><li class="md-nav__item"><a href="#example-2-limiting-bucket-access-by-hosts" title="Example 2:  Limiting Bucket Access By Hosts" class="md-nav__link">Example 2:  Limiting Bucket Access By Hosts</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><a href="https://github.com/aistairc/abci-docs/edit/master/en/docs/abci-cloudstorage/policy.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a><h1 id="access-control-2-policy-">Access Control (2) - Policy -</h1>
<p>Other than ACL, Access Control Policy is also available to define permisson for ABCI Cloud Storage account. Access Control Policy can control accessibility in different ways from the ones ACL offers. To use Access Control Policy, Usage Managers Account is necessary. If your ABCI Cloud Storage account is Users Account, ask Usage Managers to change the accessibility or to grant you appropreate permission.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Access control policies cannot be applied to buckets or objects. Therefore, there may be the cases that you need to set Access Control Policy to all ABCI Cloud Storage accounts within a group.</p>
</div>
<h2 id="default-permission">Default Permission</h2>
<p>Default setting grants all ABCI Cloud Storage accounts full-control permission to object of the group. </p>
<p>In case you use default setting, additional policy settings mentioned below is unnecessary. When detailed and complexed setting, such as granting specific ABCI Cloud Storage account only read permission, granting permission to only limited ABCI Cloud Storage accounts, are neeeded, the following instructions are helpful. </p>
<h2 id="setting-policy">Setting Policy</h2>
<!--  Once "default-sub-group" is introdued, default access permision can be changed  -->

<p>General conditions are following.</p>
<ul>
<li>Endpoint is 'https://s3.abci.ai'</li>
<li>Ruling order does not matter, and Deny is prioritized over Allow. Even Denys in otner policy has priority.</li>
<li>Although capital letters are available for the name of policies (i.e. names specified by '--policy-name'), it is highly recommended that you use small letters of alphabets and numbers and hyphen(0x2d).</li>
</ul>
<p>For policy setting, access permissions are written in JSON format. In order to define what to allow, what to deny and judgement condistions, combinations of Effect, Action, Resource and Condition are used.</p>
<p>For Effect, 'Allow' and 'Deny' are available to define rules.</p>
<p>For Action, restrictions against requests or actions are written. As for downloading objects, for example, specify 's3:GetObject.' Wildcards (e.g. s3:*) are also available.</p>
<p>Action:</p>
<ul>
<li>Bucket</li>
</ul>
<table>
<thead>
<tr>
<th align="left">Action</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">s3:CreateBucket</td>
<td align="left">Create buckets</td>
</tr>
<tr>
<td align="left">s3:DeleteBucket</td>
<td align="left">Delete buckets</td>
</tr>
<tr>
<td align="left">s3:ListBucket</td>
<td align="left">List buckets</td>
</tr>
<tr>
<td align="left">s3:PutBucketACL</td>
<td align="left">Apply ACL to buckets</td>
</tr>
<tr>
<td align="left">s3:GetBucketACL</td>
<td align="left">List ACLs applied to buckets</td>
</tr>
</tbody>
</table>
<ul>
<li>Object</li>
</ul>
<table>
<thead>
<tr>
<th align="left">Action</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">s3:GetObject</td>
<td align="left">Download objects</td>
</tr>
<tr>
<td align="left">s3:PutObject</td>
<td align="left">Upload objects</td>
</tr>
<tr>
<td align="left">s3:DeleteObject</td>
<td align="left">Delete objects</td>
</tr>
<tr>
<td align="left">s3:GetObjectACL</td>
<td align="left">Get ACL applied to object</td>
</tr>
<tr>
<td align="left">s3:PutObjectACL</td>
<td align="left">Apply ACL to objects</td>
</tr>
<tr>
<td align="left">s3:HeadObject</td>
<td align="left">Get meta dafa of object</td>
</tr>
<tr>
<td align="left">s3:CopyObject</td>
<td align="left">Copy objects</td>
</tr>
</tbody>
</table>
<!--
* Policy

| Action | Description |
| :-- | :-- |
| iam:ListUsers| Show a list of ABCI Cloud Storage account |
| iam:CreateGroup| Create a new subgroup |
| iam:DeleteGroup| Delete a subgroup |
| iam:ListGroups| Show a list of subgroups |
| iam:AddUserToGroup| Add ABCI Cloud Storage account to subgroup |
| iam:RemoveUserFromGroup| Remove ABCI Cloud Storage account from a sub-group |
| iam:ListGroupsForUser| Show subgroups to which a cloud storage user belongs |
| iam:Createpolicy| Create a new policy |
| iam:DeletePolicy| Delete a policy |
| iam:ListPolicies| Show a list of policies |
| iam:AttachGroupPolicy| Attach a policy to a subgroup |
| iam:DetachGroupPolicy| Detach a policy which attached to a subgroup |
| iam:ListAttachedGroupPolicies| Get a list of policies which attached to a subgroup |
| iam:AttachUserPolicy| Attach a policy to ABCI Cloud Storage account |
| iam:DetachUserPolicy| Detach a policy which attached to ABCI Cloud Storage account |
| iam:ListAttachedUserPolicies| Get a list of policies which attached ABCI Cloud Storage account |
-->

<p>Resouce defines accessible resources. For example, 'arn:aws:s3:::sensor8' means the bucket 'sensor8.' The object in the bucket is written as 'arn:aws:s3:::sensor8/test.dat.' Wildcards are available.</p>
<p>Condition determines condition operators and condition keys.</p>
<table>
<thead>
<tr>
<th align="left">Condition operator</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">StringEquals</td>
<td align="left">Checks if a string is identical to specified string</td>
</tr>
<tr>
<td align="left">StringNotEquals</td>
<td align="left">String condition operator that checks if a string is not identical to specified string</td>
</tr>
<tr>
<td align="left">StringLike</td>
<td align="left">String condition operator that checks if a string has specified pattern. The Wildcard for multiple letters '*' and the one for single letter '?' are available.</td>
</tr>
<tr>
<td align="left">StringNotLike</td>
<td align="left">String condition operator that checks if a string hos not specified pattern. The Wildcard for multiple letters '*' and the one for single letter '?' are available.</td>
</tr>
<tr>
<td align="left">DateLessThan</td>
<td align="left">Check if time is earlier than specified time. The format for date is '2019-09-27T01:30:00Z.'</td>
</tr>
<tr>
<td align="left">DateGreaterThan</td>
<td align="left">Check if a date is later than specified date. The format is same as DateLessThan</td>
</tr>
<tr>
<td align="left">IpAddress</td>
<td align="left">Check if an IP address is identical to specified IP address or is between specified IP address range.</td>
</tr>
<tr>
<td align="left">NotIpAddress</td>
<td align="left">Check if an IP address is not identical to specified IP address or is not between specified IP address range.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th align="left">Condition Key</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">aws:username</td>
<td align="left">Name of ABCI Cloud Storage account (e.g. aaa00000.1) checked by string condition operators.</td>
</tr>
<tr>
<td align="left">aws:SourceIp</td>
<td align="left">Check source IP address, working with IP address operator.</td>
</tr>
<tr>
<td align="left">aws:CurrentTime</td>
<td align="left">Check current time, working with date operators.</td>
</tr>
<tr>
<td align="left">aws:UserAgent</td>
<td align="left">HTTP header of User-Agent. It is not appropriate for denying access because it can be camouflaged. An appropiate way of use is, for example, to deny unintended access to the buckets that are for specific applications.</td>
</tr>
</tbody>
</table>
<p>Here is an example.
Condition element can be omitted if it is unnecessary.</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span>
<span class="err">    &quot;Statement&quot;: [</span>
<span class="err">        {</span>
<span class="err">            &quot;Effect&quot;: &quot;Deny&quot;,</span>
<span class="err">            &quot;Action&quot;: &quot;s3:*&quot;,</span>
<span class="err">            &quot;Resource&quot;: &quot;*&quot;,</span>
<span class="err">            &quot;Condition&quot;: {&quot;StringLike&quot;: {&quot;aws:UserAgent&quot; : &quot;aws-cli*&quot;}}</span>
<span class="err">        }</span>
<span class="err">    ]</span>
<span class="err">}</span>
</code></pre></div>


<p>The following examples show how to control access by policy.</p>
<h3 id="example-1-limiting-bucket-access-by-accounts">Example 1:  Limiting Bucket Access By Accounts</h3>
<p>Four ABCI Cloud Storage accounts, aaa00000.1, aaa000001.1, aaa00002.1 and aaa00003.1, are created, for example, and there is a bucket whose name is 'sensor8'.Now we are showing how to allow only two users, aaa00000.1 and aaa00001.1, to access the bucket.</p>
<p>Firstly, create a .json file whose name is 'sensor8.json', for example, as following. The name of a .json file can be arbitrary.</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span>
<span class="err">    &quot;Statement&quot;: [</span>
<span class="err">        {</span>
<span class="err">            &quot;Effect&quot;: &quot;Deny&quot;,</span>
<span class="err">            &quot;Action&quot;: &quot;s3:*&quot;,</span>
<span class="err">            &quot;Resource&quot;: [&quot;arn:aws:s3:::sensor8&quot;, &quot;arn:aws:s3:::sensor8/*&quot;],</span>
<span class="err">            &quot;Condition&quot; : { &quot;StringNotEquals&quot; : { &quot;aws:username&quot; :</span>
<span class="err">                [&quot;aaa00002.1&quot;, &quot;aaa00003.1&quot;]}}</span>
<span class="err">        }</span>
<span class="err">    ]</span>
<span class="err">}</span>
</code></pre></div>


<p>It defines the policy that doesn't allow aaa00002.1 and aaa00003.1 to access the bucket.Because 'Deny' has priority, any other 'Allow' will be skipped.</p>
<p>Secondly, register this policy to ABCI Cloud Storage.</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ aws --endpoint-url https://s3.abci.ai iam create-policy --policy-name sensor8policy --policy-document file://sensor8.json</span>
<span class="err">{</span>
<span class="err">    &quot;Policy&quot;: {</span>
<span class="err">        &quot;PolicyName&quot;: &quot;sensor8policy&quot;,</span>
<span class="err">        &quot;CreateDate&quot;: &quot;2019-07-30T06:22:47Z&quot;,</span>
<span class="err">        &quot;AttachmentCount&quot;: 0,</span>
<span class="err">        &quot;IsAttachable&quot;: true,</span>
<span class="err">        &quot;PolicyId&quot;: &quot;51OFYS8BQEFTP68KT4I63AAZYHNBPHHA&quot;,</span>
<span class="err">        &quot;DefaultVersionId&quot;: &quot;v1&quot;,</span>
<span class="err">        &quot;Path&quot;: &quot;/&quot;,</span>
<span class="err">        &quot;Arn&quot;: &quot;arn:aws:iam::123456789012:policy/sensor8policy&quot;,</span>
<span class="err">        &quot;UpdateDate&quot;: &quot;2019-07-30T06:22:47Z&quot;</span>
<span class="err">    }</span>
<span class="err">}</span>
</code></pre></div>


<p>The name of policy registered to ABCI Cloud Storage is 'sensor8policy' that includes what are written in 'sensor8.json' in the current working directory.
Take a memo and keep the value of 'Arn' which is necessary in the next step.</p>
<p>iLastly, apply the policy to the ABCI Cloud Storage accounts, aaa00002.1 and aaa00003.1.</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ aws --endpoint-url https://s3.abci.ai iam attach-user-policy --policy-arn arn:aws:iam::123456789012:policy/sensor8policy --user-name aaa00002.1</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ aws --endpoint-url https://s3.abci.ai iam attach-user-policy --policy-arn arn:aws:iam::123456789012:policy/sensor8policy --user-name aaa00003.1</span>
</code></pre></div>


<p>To clarify the ABCI Cloud Storage accounts to which the policy is applied, execute the command 'aws --endpoint-url https://s3.abci.ai iam list-attached-user-policies --user-name aaa00002.1.'</p>
<p>By applying the above rules, aaa00002.1 and aaa00003.1 can no longer access the bucket 'sensor8.' aaa00000.1 and aaa00001.1 can still access.</p>
<p>To clarify the ABCI Cloud Storage accounts to which the policy is applied, execute the command 'aws --endpoint-url https://s3.abci.ai iam list-attached-user-policies --user-name aaa00002.1.'</p>
<h3 id="example-2-limiting-bucket-access-by-hosts">Example 2:  Limiting Bucket Access By Hosts</h3>
<p>The example below shows how to limit access from certain hosts. In the example, any access from hosts other than either external host whose IP address is 203.0.113.2 or internal network whose IP address range is 10.0.0.0/17 is denied.</p>
<p>Firstly, create 'src-ip-pc.json' as following.</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span>
<span class="err">    &quot;Statement&quot;: [</span>
<span class="err">        {</span>
<span class="err">            &quot;Effect&quot;: &quot;Deny&quot;,</span>
<span class="err">            &quot;Action&quot;: &quot;s3:*&quot;,</span>
<span class="err">            &quot;Resource&quot;: &quot;*&quot;,</span>
<span class="err">            &quot;Condition&quot;: {</span>
<span class="err">                &quot;NotIpAddress&quot;: {</span>
<span class="err">                    &quot;aws:SourceIp&quot;: [</span>
<span class="err">                        &quot;10.0.0.0/17&quot;,</span>
<span class="err">                        &quot;203.0.113.2/32&quot;</span>
<span class="err">                    ]</span>
<span class="err">                }</span>
<span class="err">            }</span>
<span class="err">        }</span>
<span class="err">    ]</span>
<span class="err">}</span>
</code></pre></div>


<p>Secondly, register this policy to ABCI Cloud Storage.</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ aws --endpoint-url https://s3.abci.ai iam create-policy --policy-name src-ip-pc --policy-document file://src-ip-pc.json</span>
<span class="err">{</span>
<span class="err">    &quot;Policy&quot;: {</span>
<span class="err">        &quot;PolicyName&quot;: &quot;src-ip-pc&quot;,</span>
<span class="err">        &quot;CreateDate&quot;: &quot;2019-08-08T13:24:54Z&quot;,</span>
<span class="err">        &quot;AttachmentCount&quot;: 0,</span>
<span class="err">        &quot;IsAttachable&quot;: true,</span>
<span class="err">        &quot;PolicyId&quot;: &quot;K9B9SFWR0JL4GSY8Z1K2441VJERSC2Q7&quot;,</span>
<span class="err">        &quot;DefaultVersionId&quot;: &quot;v1&quot;,</span>
<span class="err">        &quot;Path&quot;: &quot;/&quot;,</span>
<span class="err">        &quot;Arn&quot;: &quot;arn:aws:iam::123456789012:policy/src-ip-pc&quot;,</span>
<span class="err">        &quot;UpdateDate&quot;: &quot;2019-08-08T13:24:54Z&quot;</span>
<span class="err">    }</span>
<span class="err">}</span>
</code></pre></div>


<p>Secondly, register this policy to ABCI Cloud Storage. The follwing example applies the policy to ABCI Cloud Storage account 'aaa00004.1.' The value of 'ARN' had been shown already when registering the policy though, it can also be listed by executing the command 'aws --endpoint-url https://s3.abci.ai iam list-policies.'</p>
<div class="codehilite"><pre><span></span><code><span class="err">[username@es1 ~]$ aws --endpoint-url https://s3.abci.ai iam attach-user-policy --policy-arn arn:aws:iam::123456789012:policy/src-ip-pc --user-name aaa00004.1</span>
</code></pre></div>


<p>By default setting, because no IP address limitation is defined, any ABCI Cloud Storage accounts to which the policy shown above is not applied has no limitation, regardless of sources' IP addresses. In order to list accounts in ABCI Cloud Storage, execute the command 'aws --endpoint-url https://s3.abci.ai iam list-users.'</p></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href="../acl/" title="Access Control (1) " class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Previous</span>Access Control (1) </span></div></a><a href="../../faq/" title="FAQ" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Next</span>FAQ</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright"><div class="md-footer-copyright__highlight">Copyright &copy; 2018 National Institute of Advanced Industrial Science and Technology (AIST)</div>powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div></div></div></footer></div><script src="../../assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.1",url:{base:"../.."}})</script></body></html>